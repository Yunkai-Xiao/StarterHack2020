{"ast":null,"code":"import _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport { polyfill } from 'react-lifecycles-compat';\nimport moment from 'moment';\nimport { formatDate } from '../util';\nvar cachedSelectionStart = void 0;\nvar cachedSelectionEnd = void 0;\nvar dateInputInstance = void 0;\n\nvar DateInput = function (_React$Component) {\n  _inherits(DateInput, _React$Component);\n\n  function DateInput(props) {\n    _classCallCheck(this, DateInput);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var selectedValue = props.selectedValue;\n    _this.state = {\n      str: formatDate(selectedValue, _this.props.format),\n      invalid: false,\n      hasFocus: false\n    };\n    return _this;\n  }\n\n  DateInput.prototype.componentDidUpdate = function componentDidUpdate() {\n    if (dateInputInstance && this.state.hasFocus && !this.state.invalid && !(cachedSelectionStart === 0 && cachedSelectionEnd === 0)) {\n      dateInputInstance.setSelectionRange(cachedSelectionStart, cachedSelectionEnd);\n    }\n  };\n\n  DateInput.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, state) {\n    var newState = {};\n\n    if (dateInputInstance) {\n      cachedSelectionStart = dateInputInstance.selectionStart;\n      cachedSelectionEnd = dateInputInstance.selectionEnd;\n    } // when popup show, click body will call this, bug!\n\n\n    var selectedValue = nextProps.selectedValue;\n\n    if (!state.hasFocus) {\n      newState = {\n        str: formatDate(selectedValue, nextProps.format),\n        invalid: false\n      };\n    }\n\n    return newState;\n  };\n\n  DateInput.getInstance = function getInstance() {\n    return dateInputInstance;\n  };\n\n  DateInput.prototype.render = function render() {\n    var props = this.props;\n    var _state = this.state,\n        invalid = _state.invalid,\n        str = _state.str;\n    var locale = props.locale,\n        prefixCls = props.prefixCls,\n        placeholder = props.placeholder,\n        clearIcon = props.clearIcon;\n    var invalidClass = invalid ? prefixCls + '-input-invalid' : '';\n    return React.createElement('div', {\n      className: prefixCls + '-input-wrap'\n    }, React.createElement('div', {\n      className: prefixCls + '-date-input-wrap'\n    }, React.createElement('input', {\n      ref: this.saveDateInput,\n      className: prefixCls + '-input ' + invalidClass,\n      value: str,\n      disabled: props.disabled,\n      placeholder: placeholder,\n      onChange: this.onInputChange,\n      onKeyDown: this.onKeyDown,\n      onFocus: this.onFocus,\n      onBlur: this.onBlur\n    })), props.showClear ? React.createElement('a', {\n      role: 'button',\n      title: locale.clear,\n      onClick: this.onClear\n    }, clearIcon || React.createElement('span', {\n      className: prefixCls + '-clear-btn'\n    })) : null);\n  };\n\n  return DateInput;\n}(React.Component);\n\nDateInput.propTypes = {\n  prefixCls: PropTypes.string,\n  timePicker: PropTypes.object,\n  value: PropTypes.object,\n  disabledTime: PropTypes.any,\n  format: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]),\n  locale: PropTypes.object,\n  disabledDate: PropTypes.func,\n  onChange: PropTypes.func,\n  onClear: PropTypes.func,\n  placeholder: PropTypes.string,\n  onSelect: PropTypes.func,\n  selectedValue: PropTypes.object,\n  clearIcon: PropTypes.node\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.onClear = function () {\n    _this2.setState({\n      str: ''\n    });\n\n    _this2.props.onClear(null);\n  };\n\n  this.onInputChange = function (event) {\n    var str = event.target.value;\n    var _props = _this2.props,\n        disabledDate = _props.disabledDate,\n        format = _props.format,\n        onChange = _props.onChange,\n        selectedValue = _props.selectedValue; // 没有内容，合法并直接退出\n\n    if (!str) {\n      onChange(null);\n\n      _this2.setState({\n        invalid: false,\n        str: str\n      });\n\n      return;\n    } // 不合法直接退出\n\n\n    var parsed = moment(str, format, true);\n\n    if (!parsed.isValid()) {\n      _this2.setState({\n        invalid: true,\n        str: str\n      });\n\n      return;\n    }\n\n    var value = _this2.props.value.clone();\n\n    value.year(parsed.year()).month(parsed.month()).date(parsed.date()).hour(parsed.hour()).minute(parsed.minute()).second(parsed.second());\n\n    if (!value || disabledDate && disabledDate(value)) {\n      _this2.setState({\n        invalid: true,\n        str: str\n      });\n\n      return;\n    }\n\n    if (selectedValue !== value || selectedValue && value && !selectedValue.isSame(value)) {\n      _this2.setState({\n        invalid: false,\n        str: str\n      });\n\n      onChange(value);\n    }\n  };\n\n  this.onFocus = function () {\n    _this2.setState({\n      hasFocus: true\n    });\n  };\n\n  this.onBlur = function () {\n    _this2.setState(function (prevState, prevProps) {\n      return {\n        hasFocus: false,\n        str: formatDate(prevProps.value, prevProps.format)\n      };\n    });\n  };\n\n  this.onKeyDown = function (_ref) {\n    var keyCode = _ref.keyCode;\n    var _props2 = _this2.props,\n        onSelect = _props2.onSelect,\n        value = _props2.value,\n        disabledDate = _props2.disabledDate;\n\n    if (keyCode === KeyCode.ENTER && onSelect) {\n      var validateDate = !disabledDate || !disabledDate(value);\n\n      if (validateDate) {\n        onSelect(value.clone());\n      }\n    }\n  };\n\n  this.getRootDOMNode = function () {\n    return ReactDOM.findDOMNode(_this2);\n  };\n\n  this.focus = function () {\n    if (dateInputInstance) {\n      dateInputInstance.focus();\n    }\n  };\n\n  this.saveDateInput = function (dateInput) {\n    dateInputInstance = dateInput;\n  };\n};\n\npolyfill(DateInput);\nexport default DateInput;","map":{"version":3,"sources":["/Users/SHAWN/Downloads/StudyMate2/node_modules/rc-calendar/es/date/DateInput.js"],"names":["_classCallCheck","_possibleConstructorReturn","_inherits","React","ReactDOM","PropTypes","KeyCode","polyfill","moment","formatDate","cachedSelectionStart","cachedSelectionEnd","dateInputInstance","DateInput","_React$Component","props","_this","call","_initialiseProps","selectedValue","state","str","format","invalid","hasFocus","prototype","componentDidUpdate","setSelectionRange","getDerivedStateFromProps","nextProps","newState","selectionStart","selectionEnd","getInstance","render","_state","locale","prefixCls","placeholder","clearIcon","invalidClass","createElement","className","ref","saveDateInput","value","disabled","onChange","onInputChange","onKeyDown","onFocus","onBlur","showClear","role","title","clear","onClick","onClear","Component","propTypes","string","timePicker","object","disabledTime","any","oneOfType","arrayOf","disabledDate","func","onSelect","node","_this2","setState","event","target","_props","parsed","isValid","clone","year","month","date","hour","minute","second","isSame","prevState","prevProps","_ref","keyCode","_props2","ENTER","validateDate","getRootDOMNode","findDOMNode","focus","dateInput"],"mappings":"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","sourcesContent":["import _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport { polyfill } from 'react-lifecycles-compat';\nimport moment from 'moment';\nimport { formatDate } from '../util';\n\nvar cachedSelectionStart = void 0;\nvar cachedSelectionEnd = void 0;\nvar dateInputInstance = void 0;\n\nvar DateInput = function (_React$Component) {\n  _inherits(DateInput, _React$Component);\n\n  function DateInput(props) {\n    _classCallCheck(this, DateInput);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var selectedValue = props.selectedValue;\n\n    _this.state = {\n      str: formatDate(selectedValue, _this.props.format),\n      invalid: false,\n      hasFocus: false\n    };\n    return _this;\n  }\n\n  DateInput.prototype.componentDidUpdate = function componentDidUpdate() {\n    if (dateInputInstance && this.state.hasFocus && !this.state.invalid && !(cachedSelectionStart === 0 && cachedSelectionEnd === 0)) {\n      dateInputInstance.setSelectionRange(cachedSelectionStart, cachedSelectionEnd);\n    }\n  };\n\n  DateInput.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, state) {\n    var newState = {};\n\n    if (dateInputInstance) {\n      cachedSelectionStart = dateInputInstance.selectionStart;\n      cachedSelectionEnd = dateInputInstance.selectionEnd;\n    }\n    // when popup show, click body will call this, bug!\n    var selectedValue = nextProps.selectedValue;\n    if (!state.hasFocus) {\n      newState = {\n        str: formatDate(selectedValue, nextProps.format),\n        invalid: false\n      };\n    }\n\n    return newState;\n  };\n\n  DateInput.getInstance = function getInstance() {\n    return dateInputInstance;\n  };\n\n  DateInput.prototype.render = function render() {\n    var props = this.props;\n    var _state = this.state,\n        invalid = _state.invalid,\n        str = _state.str;\n    var locale = props.locale,\n        prefixCls = props.prefixCls,\n        placeholder = props.placeholder,\n        clearIcon = props.clearIcon;\n\n    var invalidClass = invalid ? prefixCls + '-input-invalid' : '';\n    return React.createElement(\n      'div',\n      { className: prefixCls + '-input-wrap' },\n      React.createElement(\n        'div',\n        { className: prefixCls + '-date-input-wrap' },\n        React.createElement('input', {\n          ref: this.saveDateInput,\n          className: prefixCls + '-input ' + invalidClass,\n          value: str,\n          disabled: props.disabled,\n          placeholder: placeholder,\n          onChange: this.onInputChange,\n          onKeyDown: this.onKeyDown,\n          onFocus: this.onFocus,\n          onBlur: this.onBlur\n        })\n      ),\n      props.showClear ? React.createElement(\n        'a',\n        {\n          role: 'button',\n          title: locale.clear,\n          onClick: this.onClear\n        },\n        clearIcon || React.createElement('span', { className: prefixCls + '-clear-btn' })\n      ) : null\n    );\n  };\n\n  return DateInput;\n}(React.Component);\n\nDateInput.propTypes = {\n  prefixCls: PropTypes.string,\n  timePicker: PropTypes.object,\n  value: PropTypes.object,\n  disabledTime: PropTypes.any,\n  format: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]),\n  locale: PropTypes.object,\n  disabledDate: PropTypes.func,\n  onChange: PropTypes.func,\n  onClear: PropTypes.func,\n  placeholder: PropTypes.string,\n  onSelect: PropTypes.func,\n  selectedValue: PropTypes.object,\n  clearIcon: PropTypes.node\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.onClear = function () {\n    _this2.setState({\n      str: ''\n    });\n    _this2.props.onClear(null);\n  };\n\n  this.onInputChange = function (event) {\n    var str = event.target.value;\n    var _props = _this2.props,\n        disabledDate = _props.disabledDate,\n        format = _props.format,\n        onChange = _props.onChange,\n        selectedValue = _props.selectedValue;\n\n    // 没有内容，合法并直接退出\n\n    if (!str) {\n      onChange(null);\n      _this2.setState({\n        invalid: false,\n        str: str\n      });\n      return;\n    }\n\n    // 不合法直接退出\n    var parsed = moment(str, format, true);\n    if (!parsed.isValid()) {\n      _this2.setState({\n        invalid: true,\n        str: str\n      });\n      return;\n    }\n\n    var value = _this2.props.value.clone();\n    value.year(parsed.year()).month(parsed.month()).date(parsed.date()).hour(parsed.hour()).minute(parsed.minute()).second(parsed.second());\n\n    if (!value || disabledDate && disabledDate(value)) {\n      _this2.setState({\n        invalid: true,\n        str: str\n      });\n      return;\n    }\n\n    if (selectedValue !== value || selectedValue && value && !selectedValue.isSame(value)) {\n      _this2.setState({\n        invalid: false,\n        str: str\n      });\n      onChange(value);\n    }\n  };\n\n  this.onFocus = function () {\n    _this2.setState({ hasFocus: true });\n  };\n\n  this.onBlur = function () {\n    _this2.setState(function (prevState, prevProps) {\n      return {\n        hasFocus: false,\n        str: formatDate(prevProps.value, prevProps.format)\n      };\n    });\n  };\n\n  this.onKeyDown = function (_ref) {\n    var keyCode = _ref.keyCode;\n    var _props2 = _this2.props,\n        onSelect = _props2.onSelect,\n        value = _props2.value,\n        disabledDate = _props2.disabledDate;\n\n    if (keyCode === KeyCode.ENTER && onSelect) {\n      var validateDate = !disabledDate || !disabledDate(value);\n      if (validateDate) {\n        onSelect(value.clone());\n      }\n    }\n  };\n\n  this.getRootDOMNode = function () {\n    return ReactDOM.findDOMNode(_this2);\n  };\n\n  this.focus = function () {\n    if (dateInputInstance) {\n      dateInputInstance.focus();\n    }\n  };\n\n  this.saveDateInput = function (dateInput) {\n    dateInputInstance = dateInput;\n  };\n};\n\npolyfill(DateInput);\n\nexport default DateInput;"]},"metadata":{},"sourceType":"module"}