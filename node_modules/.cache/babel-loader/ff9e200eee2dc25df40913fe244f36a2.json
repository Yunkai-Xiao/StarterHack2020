{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport classnames from 'classnames';\nimport { polyfill } from 'react-lifecycles-compat';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport CalendarPart from './range-calendar/CalendarPart';\nimport TodayButton from './calendar/TodayButton';\nimport OkButton from './calendar/OkButton';\nimport TimePickerButton from './calendar/TimePickerButton';\nimport { commonMixinWrapper, propType, defaultProp } from './mixin/CommonMixin';\nimport { syncTime, getTodayTime, isAllowedDate } from './util';\nimport { goTime, goStartMonth, goEndMonth, includesTime } from './util/toTime';\n\nfunction noop() {}\n\nfunction isEmptyArray(arr) {\n  return Array.isArray(arr) && (arr.length === 0 || arr.every(function (i) {\n    return !i;\n  }));\n}\n\nfunction isArraysEqual(a, b) {\n  if (a === b) return true;\n\n  if (a === null || typeof a === 'undefined' || b === null || typeof b === 'undefined') {\n    return false;\n  }\n\n  if (a.length !== b.length) return false;\n\n  for (var i = 0; i < a.length; ++i) {\n    if (a[i] !== b[i]) return false;\n  }\n\n  return true;\n}\n\nfunction getValueFromSelectedValue(selectedValue) {\n  var start = selectedValue[0],\n      end = selectedValue[1];\n\n  if (end && (start === undefined || start === null)) {\n    start = end.clone().subtract(1, 'month');\n  }\n\n  if (start && (end === undefined || end === null)) {\n    end = start.clone().add(1, 'month');\n  }\n\n  return [start, end];\n}\n\nfunction normalizeAnchor(props, init) {\n  var selectedValue = props.selectedValue || init && props.defaultSelectedValue;\n  var value = props.value || init && props.defaultValue;\n  var normalizedValue = value ? getValueFromSelectedValue(value) : getValueFromSelectedValue(selectedValue);\n  return !isEmptyArray(normalizedValue) ? normalizedValue : init && [moment(), moment().add(1, 'months')];\n}\n\nfunction generateOptions(length, extraOptionGen) {\n  var arr = extraOptionGen ? extraOptionGen().concat() : [];\n\n  for (var value = 0; value < length; value++) {\n    if (arr.indexOf(value) === -1) {\n      arr.push(value);\n    }\n  }\n\n  return arr;\n}\n\nfunction onInputSelect(direction, value, cause) {\n  if (!value) {\n    return;\n  }\n\n  var originalValue = this.state.selectedValue;\n  var selectedValue = originalValue.concat();\n  var index = direction === 'left' ? 0 : 1;\n  selectedValue[index] = value;\n\n  if (selectedValue[0] && this.compare(selectedValue[0], selectedValue[1]) > 0) {\n    selectedValue[1 - index] = this.state.showTimePicker ? selectedValue[index] : undefined;\n  }\n\n  this.props.onInputSelect(selectedValue);\n  this.fireSelectValueChange(selectedValue, null, cause || {\n    source: 'dateInput'\n  });\n}\n\nvar RangeCalendar = function (_React$Component) {\n  _inherits(RangeCalendar, _React$Component);\n\n  function RangeCalendar(props) {\n    _classCallCheck(this, RangeCalendar);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var selectedValue = props.selectedValue || props.defaultSelectedValue;\n    var value = normalizeAnchor(props, 1);\n    _this.state = {\n      selectedValue: selectedValue,\n      prevSelectedValue: selectedValue,\n      firstSelectedValue: null,\n      hoverValue: props.hoverValue || [],\n      value: value,\n      showTimePicker: false,\n      mode: props.mode || ['date', 'date']\n    };\n    return _this;\n  }\n\n  RangeCalendar.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, state) {\n    var newState = {};\n\n    if ('value' in nextProps) {\n      newState.value = normalizeAnchor(nextProps, 0);\n    }\n\n    if ('hoverValue' in nextProps && !isArraysEqual(state.hoverValue, nextProps.hoverValue)) {\n      newState.hoverValue = nextProps.hoverValue;\n    }\n\n    if ('selectedValue' in nextProps) {\n      newState.selectedValue = nextProps.selectedValue;\n      newState.prevSelectedValue = nextProps.selectedValue;\n    }\n\n    if ('mode' in nextProps && !isArraysEqual(state.mode, nextProps.mode)) {\n      newState.mode = nextProps.mode;\n    }\n\n    return newState;\n  }; // get disabled hours for second picker\n\n\n  RangeCalendar.prototype.render = function render() {\n    var _className, _classnames;\n\n    var props = this.props,\n        state = this.state;\n    var prefixCls = props.prefixCls,\n        dateInputPlaceholder = props.dateInputPlaceholder,\n        seperator = props.seperator,\n        timePicker = props.timePicker,\n        showOk = props.showOk,\n        locale = props.locale,\n        showClear = props.showClear,\n        showToday = props.showToday,\n        type = props.type,\n        clearIcon = props.clearIcon;\n    var hoverValue = state.hoverValue,\n        selectedValue = state.selectedValue,\n        mode = state.mode,\n        showTimePicker = state.showTimePicker;\n    var className = (_className = {}, _className[props.className] = !!props.className, _className[prefixCls] = 1, _className[prefixCls + '-hidden'] = !props.visible, _className[prefixCls + '-range'] = 1, _className[prefixCls + '-show-time-picker'] = showTimePicker, _className[prefixCls + '-week-number'] = props.showWeekNumber, _className);\n    var classes = classnames(className);\n    var newProps = {\n      selectedValue: state.selectedValue,\n      onSelect: this.onSelect,\n      onDayHover: type === 'start' && selectedValue[1] || type === 'end' && selectedValue[0] || !!hoverValue.length ? this.onDayHover : undefined\n    };\n    var placeholder1 = void 0;\n    var placeholder2 = void 0;\n\n    if (dateInputPlaceholder) {\n      if (Array.isArray(dateInputPlaceholder)) {\n        placeholder1 = dateInputPlaceholder[0];\n        placeholder2 = dateInputPlaceholder[1];\n      } else {\n        placeholder1 = placeholder2 = dateInputPlaceholder;\n      }\n    }\n\n    var showOkButton = showOk === true || showOk !== false && !!timePicker;\n    var cls = classnames((_classnames = {}, _classnames[prefixCls + '-footer'] = true, _classnames[prefixCls + '-range-bottom'] = true, _classnames[prefixCls + '-footer-show-ok'] = showOkButton, _classnames));\n    var startValue = this.getStartValue();\n    var endValue = this.getEndValue();\n    var todayTime = getTodayTime(startValue);\n    var thisMonth = todayTime.month();\n    var thisYear = todayTime.year();\n    var isTodayInView = startValue.year() === thisYear && startValue.month() === thisMonth || endValue.year() === thisYear && endValue.month() === thisMonth;\n    var nextMonthOfStart = startValue.clone().add(1, 'months');\n    var isClosestMonths = nextMonthOfStart.year() === endValue.year() && nextMonthOfStart.month() === endValue.month(); // console.warn('Render:', selectedValue.map(t => t.format('YYYY-MM-DD')).join(', '));\n    // console.log('start:', startValue.format('YYYY-MM-DD'));\n    // console.log('end:', endValue.format('YYYY-MM-DD'));\n\n    var extraFooter = props.renderFooter();\n    return React.createElement('div', {\n      ref: this.saveRoot,\n      className: classes,\n      style: props.style,\n      tabIndex: '0',\n      onKeyDown: this.onKeyDown\n    }, props.renderSidebar(), React.createElement('div', {\n      className: prefixCls + '-panel'\n    }, showClear && selectedValue[0] && selectedValue[1] ? React.createElement('a', {\n      role: 'button',\n      title: locale.clear,\n      onClick: this.clear\n    }, clearIcon || React.createElement('span', {\n      className: prefixCls + '-clear-btn'\n    })) : null, React.createElement('div', {\n      className: prefixCls + '-date-panel',\n      onMouseLeave: type !== 'both' ? this.onDatePanelLeave : undefined,\n      onMouseEnter: type !== 'both' ? this.onDatePanelEnter : undefined\n    }, React.createElement(CalendarPart, _extends({}, props, newProps, {\n      hoverValue: hoverValue,\n      direction: 'left',\n      disabledTime: this.disabledStartTime,\n      disabledMonth: this.disabledStartMonth,\n      format: this.getFormat(),\n      value: startValue,\n      mode: mode[0],\n      placeholder: placeholder1,\n      onInputChange: this.onStartInputChange,\n      onInputSelect: this.onStartInputSelect,\n      onValueChange: this.onStartValueChange,\n      onPanelChange: this.onStartPanelChange,\n      showDateInput: this.props.showDateInput,\n      timePicker: timePicker,\n      showTimePicker: showTimePicker,\n      enablePrev: true,\n      enableNext: !isClosestMonths || this.isMonthYearPanelShow(mode[1]),\n      clearIcon: clearIcon\n    })), React.createElement('span', {\n      className: prefixCls + '-range-middle'\n    }, seperator), React.createElement(CalendarPart, _extends({}, props, newProps, {\n      hoverValue: hoverValue,\n      direction: 'right',\n      format: this.getFormat(),\n      timePickerDisabledTime: this.getEndDisableTime(),\n      placeholder: placeholder2,\n      value: endValue,\n      mode: mode[1],\n      onInputChange: this.onEndInputChange,\n      onInputSelect: this.onEndInputSelect,\n      onValueChange: this.onEndValueChange,\n      onPanelChange: this.onEndPanelChange,\n      showDateInput: this.props.showDateInput,\n      timePicker: timePicker,\n      showTimePicker: showTimePicker,\n      disabledTime: this.disabledEndTime,\n      disabledMonth: this.disabledEndMonth,\n      enablePrev: !isClosestMonths || this.isMonthYearPanelShow(mode[0]),\n      enableNext: true,\n      clearIcon: clearIcon\n    }))), React.createElement('div', {\n      className: cls\n    }, showToday || props.timePicker || showOkButton || extraFooter ? React.createElement('div', {\n      className: prefixCls + '-footer-btn'\n    }, extraFooter, showToday ? React.createElement(TodayButton, _extends({}, props, {\n      disabled: isTodayInView,\n      value: state.value[0],\n      onToday: this.onToday,\n      text: locale.backToToday\n    })) : null, props.timePicker ? React.createElement(TimePickerButton, _extends({}, props, {\n      showTimePicker: showTimePicker,\n      onOpenTimePicker: this.onOpenTimePicker,\n      onCloseTimePicker: this.onCloseTimePicker,\n      timePickerDisabled: !this.hasSelectedValue() || hoverValue.length\n    })) : null, showOkButton ? React.createElement(OkButton, _extends({}, props, {\n      onOk: this.onOk,\n      okDisabled: !this.isAllowedDateAndTime(selectedValue) || !this.hasSelectedValue() || hoverValue.length\n    })) : null) : null)));\n  };\n\n  return RangeCalendar;\n}(React.Component);\n\nRangeCalendar.propTypes = _extends({}, propType, {\n  prefixCls: PropTypes.string,\n  dateInputPlaceholder: PropTypes.any,\n  seperator: PropTypes.string,\n  defaultValue: PropTypes.any,\n  value: PropTypes.any,\n  hoverValue: PropTypes.any,\n  mode: PropTypes.arrayOf(PropTypes.oneOf(['date', 'month', 'year', 'decade'])),\n  showDateInput: PropTypes.bool,\n  timePicker: PropTypes.any,\n  showOk: PropTypes.bool,\n  showToday: PropTypes.bool,\n  defaultSelectedValue: PropTypes.array,\n  selectedValue: PropTypes.array,\n  onOk: PropTypes.func,\n  showClear: PropTypes.bool,\n  locale: PropTypes.object,\n  onChange: PropTypes.func,\n  onSelect: PropTypes.func,\n  onValueChange: PropTypes.func,\n  onHoverChange: PropTypes.func,\n  onPanelChange: PropTypes.func,\n  format: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n  onClear: PropTypes.func,\n  type: PropTypes.any,\n  disabledDate: PropTypes.func,\n  disabledTime: PropTypes.func,\n  clearIcon: PropTypes.node,\n  onKeyDown: PropTypes.func\n});\nRangeCalendar.defaultProps = _extends({}, defaultProp, {\n  type: 'both',\n  seperator: '~',\n  defaultSelectedValue: [],\n  onValueChange: noop,\n  onHoverChange: noop,\n  onPanelChange: noop,\n  disabledTime: noop,\n  onInputSelect: noop,\n  showToday: true,\n  showDateInput: true\n});\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.onDatePanelEnter = function () {\n    if (_this2.hasSelectedValue()) {\n      _this2.fireHoverValueChange(_this2.state.selectedValue.concat());\n    }\n  };\n\n  this.onDatePanelLeave = function () {\n    if (_this2.hasSelectedValue()) {\n      _this2.fireHoverValueChange([]);\n    }\n  };\n\n  this.onSelect = function (value) {\n    var type = _this2.props.type;\n    var _state = _this2.state,\n        selectedValue = _state.selectedValue,\n        prevSelectedValue = _state.prevSelectedValue,\n        firstSelectedValue = _state.firstSelectedValue;\n    var nextSelectedValue = void 0;\n\n    if (type === 'both') {\n      if (!firstSelectedValue) {\n        syncTime(prevSelectedValue[0], value);\n        nextSelectedValue = [value];\n      } else if (_this2.compare(firstSelectedValue, value) < 0) {\n        syncTime(prevSelectedValue[1], value);\n        nextSelectedValue = [firstSelectedValue, value];\n      } else {\n        syncTime(prevSelectedValue[0], value);\n        syncTime(prevSelectedValue[1], firstSelectedValue);\n        nextSelectedValue = [value, firstSelectedValue];\n      }\n    } else if (type === 'start') {\n      syncTime(prevSelectedValue[0], value);\n      var endValue = selectedValue[1];\n      nextSelectedValue = endValue && _this2.compare(endValue, value) > 0 ? [value, endValue] : [value];\n    } else {\n      // type === 'end'\n      var startValue = selectedValue[0];\n\n      if (startValue && _this2.compare(startValue, value) <= 0) {\n        syncTime(prevSelectedValue[1], value);\n        nextSelectedValue = [startValue, value];\n      } else {\n        syncTime(prevSelectedValue[0], value);\n        nextSelectedValue = [value];\n      }\n    }\n\n    _this2.fireSelectValueChange(nextSelectedValue);\n  };\n\n  this.onKeyDown = function (event) {\n    if (event.target.nodeName.toLowerCase() === 'input') {\n      return;\n    }\n\n    var keyCode = event.keyCode;\n    var ctrlKey = event.ctrlKey || event.metaKey;\n    var _state2 = _this2.state,\n        selectedValue = _state2.selectedValue,\n        hoverValue = _state2.hoverValue,\n        firstSelectedValue = _state2.firstSelectedValue,\n        value = _state2.value;\n    var _props = _this2.props,\n        onKeyDown = _props.onKeyDown,\n        disabledDate = _props.disabledDate; // Update last time of the picker\n\n    var updateHoverPoint = function updateHoverPoint(func) {\n      // Change hover to make focus in UI\n      var currentHoverTime = void 0;\n      var nextHoverTime = void 0;\n      var nextHoverValue = void 0;\n\n      if (!firstSelectedValue) {\n        currentHoverTime = hoverValue[0] || selectedValue[0] || value[0] || moment();\n        nextHoverTime = func(currentHoverTime);\n        nextHoverValue = [nextHoverTime];\n\n        _this2.fireHoverValueChange(nextHoverValue);\n      } else {\n        if (hoverValue.length === 1) {\n          currentHoverTime = hoverValue[0].clone();\n          nextHoverTime = func(currentHoverTime);\n          nextHoverValue = _this2.onDayHover(nextHoverTime);\n        } else {\n          currentHoverTime = hoverValue[0].isSame(firstSelectedValue, 'day') ? hoverValue[1] : hoverValue[0];\n          nextHoverTime = func(currentHoverTime);\n          nextHoverValue = _this2.onDayHover(nextHoverTime);\n        }\n      } // Find origin hover time on value index\n\n\n      if (nextHoverValue.length >= 2) {\n        var miss = nextHoverValue.some(function (ht) {\n          return !includesTime(value, ht, 'month');\n        });\n\n        if (miss) {\n          var newValue = nextHoverValue.slice().sort(function (t1, t2) {\n            return t1.valueOf() - t2.valueOf();\n          });\n\n          if (newValue[0].isSame(newValue[1], 'month')) {\n            newValue[1] = newValue[0].clone().add(1, 'month');\n          }\n\n          _this2.fireValueChange(newValue);\n        }\n      } else if (nextHoverValue.length === 1) {\n        // If only one value, let's keep the origin panel\n        var oriValueIndex = value.findIndex(function (time) {\n          return time.isSame(currentHoverTime, 'month');\n        });\n        if (oriValueIndex === -1) oriValueIndex = 0;\n\n        if (value.every(function (time) {\n          return !time.isSame(nextHoverTime, 'month');\n        })) {\n          var _newValue = value.slice();\n\n          _newValue[oriValueIndex] = nextHoverTime.clone();\n\n          _this2.fireValueChange(_newValue);\n        }\n      }\n\n      event.preventDefault();\n      return nextHoverTime;\n    };\n\n    switch (keyCode) {\n      case KeyCode.DOWN:\n        updateHoverPoint(function (time) {\n          return goTime(time, 1, 'weeks');\n        });\n        return;\n\n      case KeyCode.UP:\n        updateHoverPoint(function (time) {\n          return goTime(time, -1, 'weeks');\n        });\n        return;\n\n      case KeyCode.LEFT:\n        if (ctrlKey) {\n          updateHoverPoint(function (time) {\n            return goTime(time, -1, 'years');\n          });\n        } else {\n          updateHoverPoint(function (time) {\n            return goTime(time, -1, 'days');\n          });\n        }\n\n        return;\n\n      case KeyCode.RIGHT:\n        if (ctrlKey) {\n          updateHoverPoint(function (time) {\n            return goTime(time, 1, 'years');\n          });\n        } else {\n          updateHoverPoint(function (time) {\n            return goTime(time, 1, 'days');\n          });\n        }\n\n        return;\n\n      case KeyCode.HOME:\n        updateHoverPoint(function (time) {\n          return goStartMonth(time);\n        });\n        return;\n\n      case KeyCode.END:\n        updateHoverPoint(function (time) {\n          return goEndMonth(time);\n        });\n        return;\n\n      case KeyCode.PAGE_DOWN:\n        updateHoverPoint(function (time) {\n          return goTime(time, 1, 'month');\n        });\n        return;\n\n      case KeyCode.PAGE_UP:\n        updateHoverPoint(function (time) {\n          return goTime(time, -1, 'month');\n        });\n        return;\n\n      case KeyCode.ENTER:\n        {\n          var lastValue = void 0;\n\n          if (hoverValue.length === 0) {\n            lastValue = updateHoverPoint(function (time) {\n              return time;\n            });\n          } else if (hoverValue.length === 1) {\n            lastValue = hoverValue[0];\n          } else {\n            lastValue = hoverValue[0].isSame(firstSelectedValue, 'day') ? hoverValue[1] : hoverValue[0];\n          }\n\n          if (lastValue && (!disabledDate || !disabledDate(lastValue))) {\n            _this2.onSelect(lastValue);\n          }\n\n          event.preventDefault();\n          return;\n        }\n\n      default:\n        if (onKeyDown) {\n          onKeyDown(event);\n        }\n\n    }\n  };\n\n  this.onDayHover = function (value) {\n    var hoverValue = [];\n    var _state3 = _this2.state,\n        selectedValue = _state3.selectedValue,\n        firstSelectedValue = _state3.firstSelectedValue;\n    var type = _this2.props.type;\n\n    if (type === 'start' && selectedValue[1]) {\n      hoverValue = _this2.compare(value, selectedValue[1]) < 0 ? [value, selectedValue[1]] : [value];\n    } else if (type === 'end' && selectedValue[0]) {\n      hoverValue = _this2.compare(value, selectedValue[0]) > 0 ? [selectedValue[0], value] : [];\n    } else {\n      if (!firstSelectedValue) {\n        if (_this2.state.hoverValue.length) {\n          _this2.setState({\n            hoverValue: []\n          });\n        }\n\n        return hoverValue;\n      }\n\n      hoverValue = _this2.compare(value, firstSelectedValue) < 0 ? [value, firstSelectedValue] : [firstSelectedValue, value];\n    }\n\n    _this2.fireHoverValueChange(hoverValue);\n\n    return hoverValue;\n  };\n\n  this.onToday = function () {\n    var startValue = getTodayTime(_this2.state.value[0]);\n    var endValue = startValue.clone().add(1, 'months');\n\n    _this2.setState({\n      value: [startValue, endValue]\n    });\n  };\n\n  this.onOpenTimePicker = function () {\n    _this2.setState({\n      showTimePicker: true\n    });\n  };\n\n  this.onCloseTimePicker = function () {\n    _this2.setState({\n      showTimePicker: false\n    });\n  };\n\n  this.onOk = function () {\n    var selectedValue = _this2.state.selectedValue;\n\n    if (_this2.isAllowedDateAndTime(selectedValue)) {\n      _this2.props.onOk(_this2.state.selectedValue);\n    }\n  };\n\n  this.onStartInputChange = function () {\n    for (var _len = arguments.length, oargs = Array(_len), _key = 0; _key < _len; _key++) {\n      oargs[_key] = arguments[_key];\n    }\n\n    var args = ['left'].concat(oargs);\n    return onInputSelect.apply(_this2, args);\n  };\n\n  this.onEndInputChange = function () {\n    for (var _len2 = arguments.length, oargs = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      oargs[_key2] = arguments[_key2];\n    }\n\n    var args = ['right'].concat(oargs);\n    return onInputSelect.apply(_this2, args);\n  };\n\n  this.onStartInputSelect = function (value) {\n    var args = ['left', value, {\n      source: 'dateInputSelect'\n    }];\n    return onInputSelect.apply(_this2, args);\n  };\n\n  this.onEndInputSelect = function (value) {\n    var args = ['right', value, {\n      source: 'dateInputSelect'\n    }];\n    return onInputSelect.apply(_this2, args);\n  };\n\n  this.onStartValueChange = function (leftValue) {\n    var value = [].concat(_this2.state.value);\n    value[0] = leftValue;\n    return _this2.fireValueChange(value);\n  };\n\n  this.onEndValueChange = function (rightValue) {\n    var value = [].concat(_this2.state.value);\n    value[1] = rightValue;\n    return _this2.fireValueChange(value);\n  };\n\n  this.onStartPanelChange = function (value, mode) {\n    var props = _this2.props,\n        state = _this2.state;\n    var newMode = [mode, state.mode[1]];\n\n    if (!('mode' in props)) {\n      _this2.setState({\n        mode: newMode\n      });\n    }\n\n    var newValue = [value || state.value[0], state.value[1]];\n    props.onPanelChange(newValue, newMode);\n  };\n\n  this.onEndPanelChange = function (value, mode) {\n    var props = _this2.props,\n        state = _this2.state;\n    var newMode = [state.mode[0], mode];\n\n    if (!('mode' in props)) {\n      _this2.setState({\n        mode: newMode\n      });\n    }\n\n    var newValue = [state.value[0], value || state.value[1]];\n    props.onPanelChange(newValue, newMode);\n  };\n\n  this.getStartValue = function () {\n    var value = _this2.state.value[0];\n    var selectedValue = _this2.state.selectedValue; // keep selectedTime when select date\n\n    if (selectedValue[0] && _this2.props.timePicker) {\n      value = value.clone();\n      syncTime(selectedValue[0], value);\n    }\n\n    if (_this2.state.showTimePicker && selectedValue[0]) {\n      return selectedValue[0];\n    }\n\n    return value;\n  };\n\n  this.getEndValue = function () {\n    var _state4 = _this2.state,\n        value = _state4.value,\n        selectedValue = _state4.selectedValue,\n        showTimePicker = _state4.showTimePicker;\n    var endValue = value[1] ? value[1].clone() : value[0].clone().add(1, 'month'); // keep selectedTime when select date\n\n    if (selectedValue[1] && _this2.props.timePicker) {\n      syncTime(selectedValue[1], endValue);\n    }\n\n    if (showTimePicker) {\n      return selectedValue[1] ? selectedValue[1] : _this2.getStartValue();\n    }\n\n    return endValue;\n  };\n\n  this.getEndDisableTime = function () {\n    var _state5 = _this2.state,\n        selectedValue = _state5.selectedValue,\n        value = _state5.value;\n    var disabledTime = _this2.props.disabledTime;\n    var userSettingDisabledTime = disabledTime(selectedValue, 'end') || {};\n    var startValue = selectedValue && selectedValue[0] || value[0].clone(); // if startTime and endTime is same day..\n    // the second time picker will not able to pick time before first time picker\n\n    if (!selectedValue[1] || startValue.isSame(selectedValue[1], 'day')) {\n      var hours = startValue.hour();\n      var minutes = startValue.minute();\n      var second = startValue.second();\n      var _disabledHours = userSettingDisabledTime.disabledHours,\n          _disabledMinutes = userSettingDisabledTime.disabledMinutes,\n          _disabledSeconds = userSettingDisabledTime.disabledSeconds;\n      var oldDisabledMinutes = _disabledMinutes ? _disabledMinutes() : [];\n      var olddisabledSeconds = _disabledSeconds ? _disabledSeconds() : [];\n      _disabledHours = generateOptions(hours, _disabledHours);\n      _disabledMinutes = generateOptions(minutes, _disabledMinutes);\n      _disabledSeconds = generateOptions(second, _disabledSeconds);\n      return {\n        disabledHours: function disabledHours() {\n          return _disabledHours;\n        },\n        disabledMinutes: function disabledMinutes(hour) {\n          if (hour === hours) {\n            return _disabledMinutes;\n          }\n\n          return oldDisabledMinutes;\n        },\n        disabledSeconds: function disabledSeconds(hour, minute) {\n          if (hour === hours && minute === minutes) {\n            return _disabledSeconds;\n          }\n\n          return olddisabledSeconds;\n        }\n      };\n    }\n\n    return userSettingDisabledTime;\n  };\n\n  this.isAllowedDateAndTime = function (selectedValue) {\n    return isAllowedDate(selectedValue[0], _this2.props.disabledDate, _this2.disabledStartTime) && isAllowedDate(selectedValue[1], _this2.props.disabledDate, _this2.disabledEndTime);\n  };\n\n  this.isMonthYearPanelShow = function (mode) {\n    return ['month', 'year', 'decade'].indexOf(mode) > -1;\n  };\n\n  this.hasSelectedValue = function () {\n    var selectedValue = _this2.state.selectedValue;\n    return !!selectedValue[1] && !!selectedValue[0];\n  };\n\n  this.compare = function (v1, v2) {\n    if (_this2.props.timePicker) {\n      return v1.diff(v2);\n    }\n\n    return v1.diff(v2, 'days');\n  };\n\n  this.fireSelectValueChange = function (selectedValue, direct, cause) {\n    var timePicker = _this2.props.timePicker;\n    var prevSelectedValue = _this2.state.prevSelectedValue;\n\n    if (timePicker && timePicker.props.defaultValue) {\n      var timePickerDefaultValue = timePicker.props.defaultValue;\n\n      if (!prevSelectedValue[0] && selectedValue[0]) {\n        syncTime(timePickerDefaultValue[0], selectedValue[0]);\n      }\n\n      if (!prevSelectedValue[1] && selectedValue[1]) {\n        syncTime(timePickerDefaultValue[1], selectedValue[1]);\n      }\n    }\n\n    if (!('selectedValue' in _this2.props)) {\n      _this2.setState({\n        selectedValue: selectedValue\n      });\n    } // 尚未选择过时间，直接输入的话\n\n\n    if (!_this2.state.selectedValue[0] || !_this2.state.selectedValue[1]) {\n      var startValue = selectedValue[0] || moment();\n      var endValue = selectedValue[1] || startValue.clone().add(1, 'months');\n\n      _this2.setState({\n        selectedValue: selectedValue,\n        value: getValueFromSelectedValue([startValue, endValue])\n      });\n    }\n\n    if (selectedValue[0] && !selectedValue[1]) {\n      _this2.setState({\n        firstSelectedValue: selectedValue[0]\n      });\n\n      _this2.fireHoverValueChange(selectedValue.concat());\n    }\n\n    _this2.props.onChange(selectedValue);\n\n    if (direct || selectedValue[0] && selectedValue[1]) {\n      _this2.setState({\n        prevSelectedValue: selectedValue,\n        firstSelectedValue: null\n      });\n\n      _this2.fireHoverValueChange([]);\n\n      _this2.props.onSelect(selectedValue, cause);\n    }\n  };\n\n  this.fireValueChange = function (value) {\n    var props = _this2.props;\n\n    if (!('value' in props)) {\n      _this2.setState({\n        value: value\n      });\n    }\n\n    props.onValueChange(value);\n  };\n\n  this.fireHoverValueChange = function (hoverValue) {\n    var props = _this2.props;\n\n    if (!('hoverValue' in props)) {\n      _this2.setState({\n        hoverValue: hoverValue\n      });\n    }\n\n    props.onHoverChange(hoverValue);\n  };\n\n  this.clear = function () {\n    _this2.fireSelectValueChange([], true);\n\n    _this2.props.onClear();\n  };\n\n  this.disabledStartTime = function (time) {\n    return _this2.props.disabledTime(time, 'start');\n  };\n\n  this.disabledEndTime = function (time) {\n    return _this2.props.disabledTime(time, 'end');\n  };\n\n  this.disabledStartMonth = function (month) {\n    var value = _this2.state.value;\n    return month.isAfter(value[1], 'month');\n  };\n\n  this.disabledEndMonth = function (month) {\n    var value = _this2.state.value;\n    return month.isBefore(value[0], 'month');\n  };\n};\n\npolyfill(RangeCalendar);\nexport default commonMixinWrapper(RangeCalendar);","map":{"version":3,"sources":["/Users/SHAWN/Downloads/StudyMate2/node_modules/rc-calendar/es/RangeCalendar.js"],"names":["_extends","_classCallCheck","_possibleConstructorReturn","_inherits","React","PropTypes","moment","classnames","polyfill","KeyCode","CalendarPart","TodayButton","OkButton","TimePickerButton","commonMixinWrapper","propType","defaultProp","syncTime","getTodayTime","isAllowedDate","goTime","goStartMonth","goEndMonth","includesTime","noop","isEmptyArray","arr","Array","isArray","length","every","i","isArraysEqual","a","b","getValueFromSelectedValue","selectedValue","start","end","undefined","clone","subtract","add","normalizeAnchor","props","init","defaultSelectedValue","value","defaultValue","normalizedValue","generateOptions","extraOptionGen","concat","indexOf","push","onInputSelect","direction","cause","originalValue","state","index","compare","showTimePicker","fireSelectValueChange","source","RangeCalendar","_React$Component","_this","call","_initialiseProps","prevSelectedValue","firstSelectedValue","hoverValue","mode","getDerivedStateFromProps","nextProps","newState","prototype","render","_className","_classnames","prefixCls","dateInputPlaceholder","seperator","timePicker","showOk","locale","showClear","showToday","type","clearIcon","className","visible","showWeekNumber","classes","newProps","onSelect","onDayHover","placeholder1","placeholder2","showOkButton","cls","startValue","getStartValue","endValue","getEndValue","todayTime","thisMonth","month","thisYear","year","isTodayInView","nextMonthOfStart","isClosestMonths","extraFooter","renderFooter","createElement","ref","saveRoot","style","tabIndex","onKeyDown","renderSidebar","role","title","clear","onClick","onMouseLeave","onDatePanelLeave","onMouseEnter","onDatePanelEnter","disabledTime","disabledStartTime","disabledMonth","disabledStartMonth","format","getFormat","placeholder","onInputChange","onStartInputChange","onStartInputSelect","onValueChange","onStartValueChange","onPanelChange","onStartPanelChange","showDateInput","enablePrev","enableNext","isMonthYearPanelShow","timePickerDisabledTime","getEndDisableTime","onEndInputChange","onEndInputSelect","onEndValueChange","onEndPanelChange","disabledEndTime","disabledEndMonth","disabled","onToday","text","backToToday","onOpenTimePicker","onCloseTimePicker","timePickerDisabled","hasSelectedValue","onOk","okDisabled","isAllowedDateAndTime","Component","propTypes","string","any","arrayOf","oneOf","bool","array","func","object","onChange","onHoverChange","oneOfType","onClear","disabledDate","node","defaultProps","_this2","fireHoverValueChange","_state","nextSelectedValue","event","target","nodeName","toLowerCase","keyCode","ctrlKey","metaKey","_state2","_props","updateHoverPoint","currentHoverTime","nextHoverTime","nextHoverValue","isSame","miss","some","ht","newValue","slice","sort","t1","t2","valueOf","fireValueChange","oriValueIndex","findIndex","time","_newValue","preventDefault","DOWN","UP","LEFT","RIGHT","HOME","END","PAGE_DOWN","PAGE_UP","ENTER","lastValue","_state3","setState","_len","arguments","oargs","_key","args","apply","_len2","_key2","leftValue","rightValue","newMode","_state4","_state5","userSettingDisabledTime","hours","hour","minutes","minute","second","_disabledHours","disabledHours","_disabledMinutes","disabledMinutes","_disabledSeconds","disabledSeconds","oldDisabledMinutes","olddisabledSeconds","v1","v2","diff","direct","timePickerDefaultValue","isAfter","isBefore"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport classnames from 'classnames';\nimport { polyfill } from 'react-lifecycles-compat';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport CalendarPart from './range-calendar/CalendarPart';\nimport TodayButton from './calendar/TodayButton';\nimport OkButton from './calendar/OkButton';\nimport TimePickerButton from './calendar/TimePickerButton';\nimport { commonMixinWrapper, propType, defaultProp } from './mixin/CommonMixin';\nimport { syncTime, getTodayTime, isAllowedDate } from './util';\nimport { goTime, goStartMonth, goEndMonth, includesTime } from './util/toTime';\n\nfunction noop() {}\n\nfunction isEmptyArray(arr) {\n  return Array.isArray(arr) && (arr.length === 0 || arr.every(function (i) {\n    return !i;\n  }));\n}\n\nfunction isArraysEqual(a, b) {\n  if (a === b) return true;\n  if (a === null || typeof a === 'undefined' || b === null || typeof b === 'undefined') {\n    return false;\n  }\n  if (a.length !== b.length) return false;\n\n  for (var i = 0; i < a.length; ++i) {\n    if (a[i] !== b[i]) return false;\n  }\n  return true;\n}\n\nfunction getValueFromSelectedValue(selectedValue) {\n  var start = selectedValue[0],\n      end = selectedValue[1];\n\n  if (end && (start === undefined || start === null)) {\n    start = end.clone().subtract(1, 'month');\n  }\n\n  if (start && (end === undefined || end === null)) {\n    end = start.clone().add(1, 'month');\n  }\n  return [start, end];\n}\n\nfunction normalizeAnchor(props, init) {\n  var selectedValue = props.selectedValue || init && props.defaultSelectedValue;\n  var value = props.value || init && props.defaultValue;\n  var normalizedValue = value ? getValueFromSelectedValue(value) : getValueFromSelectedValue(selectedValue);\n  return !isEmptyArray(normalizedValue) ? normalizedValue : init && [moment(), moment().add(1, 'months')];\n}\n\nfunction generateOptions(length, extraOptionGen) {\n  var arr = extraOptionGen ? extraOptionGen().concat() : [];\n  for (var value = 0; value < length; value++) {\n    if (arr.indexOf(value) === -1) {\n      arr.push(value);\n    }\n  }\n  return arr;\n}\n\nfunction onInputSelect(direction, value, cause) {\n  if (!value) {\n    return;\n  }\n  var originalValue = this.state.selectedValue;\n  var selectedValue = originalValue.concat();\n  var index = direction === 'left' ? 0 : 1;\n  selectedValue[index] = value;\n  if (selectedValue[0] && this.compare(selectedValue[0], selectedValue[1]) > 0) {\n    selectedValue[1 - index] = this.state.showTimePicker ? selectedValue[index] : undefined;\n  }\n  this.props.onInputSelect(selectedValue);\n  this.fireSelectValueChange(selectedValue, null, cause || { source: 'dateInput' });\n}\n\nvar RangeCalendar = function (_React$Component) {\n  _inherits(RangeCalendar, _React$Component);\n\n  function RangeCalendar(props) {\n    _classCallCheck(this, RangeCalendar);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var selectedValue = props.selectedValue || props.defaultSelectedValue;\n    var value = normalizeAnchor(props, 1);\n    _this.state = {\n      selectedValue: selectedValue,\n      prevSelectedValue: selectedValue,\n      firstSelectedValue: null,\n      hoverValue: props.hoverValue || [],\n      value: value,\n      showTimePicker: false,\n      mode: props.mode || ['date', 'date']\n    };\n    return _this;\n  }\n\n  RangeCalendar.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, state) {\n    var newState = {};\n    if ('value' in nextProps) {\n      newState.value = normalizeAnchor(nextProps, 0);\n    }\n    if ('hoverValue' in nextProps && !isArraysEqual(state.hoverValue, nextProps.hoverValue)) {\n      newState.hoverValue = nextProps.hoverValue;\n    }\n    if ('selectedValue' in nextProps) {\n      newState.selectedValue = nextProps.selectedValue;\n      newState.prevSelectedValue = nextProps.selectedValue;\n    }\n    if ('mode' in nextProps && !isArraysEqual(state.mode, nextProps.mode)) {\n      newState.mode = nextProps.mode;\n    }\n    return newState;\n  };\n\n  // get disabled hours for second picker\n\n\n  RangeCalendar.prototype.render = function render() {\n    var _className, _classnames;\n\n    var props = this.props,\n        state = this.state;\n    var prefixCls = props.prefixCls,\n        dateInputPlaceholder = props.dateInputPlaceholder,\n        seperator = props.seperator,\n        timePicker = props.timePicker,\n        showOk = props.showOk,\n        locale = props.locale,\n        showClear = props.showClear,\n        showToday = props.showToday,\n        type = props.type,\n        clearIcon = props.clearIcon;\n    var hoverValue = state.hoverValue,\n        selectedValue = state.selectedValue,\n        mode = state.mode,\n        showTimePicker = state.showTimePicker;\n\n    var className = (_className = {}, _className[props.className] = !!props.className, _className[prefixCls] = 1, _className[prefixCls + '-hidden'] = !props.visible, _className[prefixCls + '-range'] = 1, _className[prefixCls + '-show-time-picker'] = showTimePicker, _className[prefixCls + '-week-number'] = props.showWeekNumber, _className);\n    var classes = classnames(className);\n    var newProps = {\n      selectedValue: state.selectedValue,\n      onSelect: this.onSelect,\n      onDayHover: type === 'start' && selectedValue[1] || type === 'end' && selectedValue[0] || !!hoverValue.length ? this.onDayHover : undefined\n    };\n\n    var placeholder1 = void 0;\n    var placeholder2 = void 0;\n\n    if (dateInputPlaceholder) {\n      if (Array.isArray(dateInputPlaceholder)) {\n        placeholder1 = dateInputPlaceholder[0];\n        placeholder2 = dateInputPlaceholder[1];\n      } else {\n        placeholder1 = placeholder2 = dateInputPlaceholder;\n      }\n    }\n    var showOkButton = showOk === true || showOk !== false && !!timePicker;\n    var cls = classnames((_classnames = {}, _classnames[prefixCls + '-footer'] = true, _classnames[prefixCls + '-range-bottom'] = true, _classnames[prefixCls + '-footer-show-ok'] = showOkButton, _classnames));\n\n    var startValue = this.getStartValue();\n    var endValue = this.getEndValue();\n    var todayTime = getTodayTime(startValue);\n    var thisMonth = todayTime.month();\n    var thisYear = todayTime.year();\n    var isTodayInView = startValue.year() === thisYear && startValue.month() === thisMonth || endValue.year() === thisYear && endValue.month() === thisMonth;\n    var nextMonthOfStart = startValue.clone().add(1, 'months');\n    var isClosestMonths = nextMonthOfStart.year() === endValue.year() && nextMonthOfStart.month() === endValue.month();\n\n    // console.warn('Render:', selectedValue.map(t => t.format('YYYY-MM-DD')).join(', '));\n    // console.log('start:', startValue.format('YYYY-MM-DD'));\n    // console.log('end:', endValue.format('YYYY-MM-DD'));\n\n    var extraFooter = props.renderFooter();\n\n    return React.createElement(\n      'div',\n      {\n        ref: this.saveRoot,\n        className: classes,\n        style: props.style,\n        tabIndex: '0',\n        onKeyDown: this.onKeyDown\n      },\n      props.renderSidebar(),\n      React.createElement(\n        'div',\n        { className: prefixCls + '-panel' },\n        showClear && selectedValue[0] && selectedValue[1] ? React.createElement(\n          'a',\n          {\n            role: 'button',\n            title: locale.clear,\n            onClick: this.clear\n          },\n          clearIcon || React.createElement('span', { className: prefixCls + '-clear-btn' })\n        ) : null,\n        React.createElement(\n          'div',\n          {\n            className: prefixCls + '-date-panel',\n            onMouseLeave: type !== 'both' ? this.onDatePanelLeave : undefined,\n            onMouseEnter: type !== 'both' ? this.onDatePanelEnter : undefined\n          },\n          React.createElement(CalendarPart, _extends({}, props, newProps, {\n            hoverValue: hoverValue,\n            direction: 'left',\n            disabledTime: this.disabledStartTime,\n            disabledMonth: this.disabledStartMonth,\n            format: this.getFormat(),\n            value: startValue,\n            mode: mode[0],\n            placeholder: placeholder1,\n            onInputChange: this.onStartInputChange,\n            onInputSelect: this.onStartInputSelect,\n            onValueChange: this.onStartValueChange,\n            onPanelChange: this.onStartPanelChange,\n            showDateInput: this.props.showDateInput,\n            timePicker: timePicker,\n            showTimePicker: showTimePicker,\n            enablePrev: true,\n            enableNext: !isClosestMonths || this.isMonthYearPanelShow(mode[1]),\n            clearIcon: clearIcon\n          })),\n          React.createElement(\n            'span',\n            { className: prefixCls + '-range-middle' },\n            seperator\n          ),\n          React.createElement(CalendarPart, _extends({}, props, newProps, {\n            hoverValue: hoverValue,\n            direction: 'right',\n            format: this.getFormat(),\n            timePickerDisabledTime: this.getEndDisableTime(),\n            placeholder: placeholder2,\n            value: endValue,\n            mode: mode[1],\n            onInputChange: this.onEndInputChange,\n            onInputSelect: this.onEndInputSelect,\n            onValueChange: this.onEndValueChange,\n            onPanelChange: this.onEndPanelChange,\n            showDateInput: this.props.showDateInput,\n            timePicker: timePicker,\n            showTimePicker: showTimePicker,\n            disabledTime: this.disabledEndTime,\n            disabledMonth: this.disabledEndMonth,\n            enablePrev: !isClosestMonths || this.isMonthYearPanelShow(mode[0]),\n            enableNext: true,\n            clearIcon: clearIcon\n          }))\n        ),\n        React.createElement(\n          'div',\n          { className: cls },\n          showToday || props.timePicker || showOkButton || extraFooter ? React.createElement(\n            'div',\n            { className: prefixCls + '-footer-btn' },\n            extraFooter,\n            showToday ? React.createElement(TodayButton, _extends({}, props, {\n              disabled: isTodayInView,\n              value: state.value[0],\n              onToday: this.onToday,\n              text: locale.backToToday\n            })) : null,\n            props.timePicker ? React.createElement(TimePickerButton, _extends({}, props, {\n              showTimePicker: showTimePicker,\n              onOpenTimePicker: this.onOpenTimePicker,\n              onCloseTimePicker: this.onCloseTimePicker,\n              timePickerDisabled: !this.hasSelectedValue() || hoverValue.length\n            })) : null,\n            showOkButton ? React.createElement(OkButton, _extends({}, props, {\n              onOk: this.onOk,\n              okDisabled: !this.isAllowedDateAndTime(selectedValue) || !this.hasSelectedValue() || hoverValue.length\n            })) : null\n          ) : null\n        )\n      )\n    );\n  };\n\n  return RangeCalendar;\n}(React.Component);\n\nRangeCalendar.propTypes = _extends({}, propType, {\n  prefixCls: PropTypes.string,\n  dateInputPlaceholder: PropTypes.any,\n  seperator: PropTypes.string,\n  defaultValue: PropTypes.any,\n  value: PropTypes.any,\n  hoverValue: PropTypes.any,\n  mode: PropTypes.arrayOf(PropTypes.oneOf(['date', 'month', 'year', 'decade'])),\n  showDateInput: PropTypes.bool,\n  timePicker: PropTypes.any,\n  showOk: PropTypes.bool,\n  showToday: PropTypes.bool,\n  defaultSelectedValue: PropTypes.array,\n  selectedValue: PropTypes.array,\n  onOk: PropTypes.func,\n  showClear: PropTypes.bool,\n  locale: PropTypes.object,\n  onChange: PropTypes.func,\n  onSelect: PropTypes.func,\n  onValueChange: PropTypes.func,\n  onHoverChange: PropTypes.func,\n  onPanelChange: PropTypes.func,\n  format: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n  onClear: PropTypes.func,\n  type: PropTypes.any,\n  disabledDate: PropTypes.func,\n  disabledTime: PropTypes.func,\n  clearIcon: PropTypes.node,\n  onKeyDown: PropTypes.func\n});\nRangeCalendar.defaultProps = _extends({}, defaultProp, {\n  type: 'both',\n  seperator: '~',\n  defaultSelectedValue: [],\n  onValueChange: noop,\n  onHoverChange: noop,\n  onPanelChange: noop,\n  disabledTime: noop,\n  onInputSelect: noop,\n  showToday: true,\n  showDateInput: true\n});\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.onDatePanelEnter = function () {\n    if (_this2.hasSelectedValue()) {\n      _this2.fireHoverValueChange(_this2.state.selectedValue.concat());\n    }\n  };\n\n  this.onDatePanelLeave = function () {\n    if (_this2.hasSelectedValue()) {\n      _this2.fireHoverValueChange([]);\n    }\n  };\n\n  this.onSelect = function (value) {\n    var type = _this2.props.type;\n    var _state = _this2.state,\n        selectedValue = _state.selectedValue,\n        prevSelectedValue = _state.prevSelectedValue,\n        firstSelectedValue = _state.firstSelectedValue;\n\n    var nextSelectedValue = void 0;\n    if (type === 'both') {\n      if (!firstSelectedValue) {\n        syncTime(prevSelectedValue[0], value);\n        nextSelectedValue = [value];\n      } else if (_this2.compare(firstSelectedValue, value) < 0) {\n        syncTime(prevSelectedValue[1], value);\n        nextSelectedValue = [firstSelectedValue, value];\n      } else {\n        syncTime(prevSelectedValue[0], value);\n        syncTime(prevSelectedValue[1], firstSelectedValue);\n        nextSelectedValue = [value, firstSelectedValue];\n      }\n    } else if (type === 'start') {\n      syncTime(prevSelectedValue[0], value);\n      var endValue = selectedValue[1];\n      nextSelectedValue = endValue && _this2.compare(endValue, value) > 0 ? [value, endValue] : [value];\n    } else {\n      // type === 'end'\n      var startValue = selectedValue[0];\n      if (startValue && _this2.compare(startValue, value) <= 0) {\n        syncTime(prevSelectedValue[1], value);\n        nextSelectedValue = [startValue, value];\n      } else {\n        syncTime(prevSelectedValue[0], value);\n        nextSelectedValue = [value];\n      }\n    }\n\n    _this2.fireSelectValueChange(nextSelectedValue);\n  };\n\n  this.onKeyDown = function (event) {\n    if (event.target.nodeName.toLowerCase() === 'input') {\n      return;\n    }\n\n    var keyCode = event.keyCode;\n\n    var ctrlKey = event.ctrlKey || event.metaKey;\n\n    var _state2 = _this2.state,\n        selectedValue = _state2.selectedValue,\n        hoverValue = _state2.hoverValue,\n        firstSelectedValue = _state2.firstSelectedValue,\n        value = _state2.value;\n    var _props = _this2.props,\n        onKeyDown = _props.onKeyDown,\n        disabledDate = _props.disabledDate;\n\n    // Update last time of the picker\n\n    var updateHoverPoint = function updateHoverPoint(func) {\n      // Change hover to make focus in UI\n      var currentHoverTime = void 0;\n      var nextHoverTime = void 0;\n      var nextHoverValue = void 0;\n\n      if (!firstSelectedValue) {\n        currentHoverTime = hoverValue[0] || selectedValue[0] || value[0] || moment();\n        nextHoverTime = func(currentHoverTime);\n        nextHoverValue = [nextHoverTime];\n        _this2.fireHoverValueChange(nextHoverValue);\n      } else {\n        if (hoverValue.length === 1) {\n          currentHoverTime = hoverValue[0].clone();\n          nextHoverTime = func(currentHoverTime);\n          nextHoverValue = _this2.onDayHover(nextHoverTime);\n        } else {\n          currentHoverTime = hoverValue[0].isSame(firstSelectedValue, 'day') ? hoverValue[1] : hoverValue[0];\n          nextHoverTime = func(currentHoverTime);\n          nextHoverValue = _this2.onDayHover(nextHoverTime);\n        }\n      }\n\n      // Find origin hover time on value index\n      if (nextHoverValue.length >= 2) {\n        var miss = nextHoverValue.some(function (ht) {\n          return !includesTime(value, ht, 'month');\n        });\n        if (miss) {\n          var newValue = nextHoverValue.slice().sort(function (t1, t2) {\n            return t1.valueOf() - t2.valueOf();\n          });\n          if (newValue[0].isSame(newValue[1], 'month')) {\n            newValue[1] = newValue[0].clone().add(1, 'month');\n          }\n          _this2.fireValueChange(newValue);\n        }\n      } else if (nextHoverValue.length === 1) {\n        // If only one value, let's keep the origin panel\n        var oriValueIndex = value.findIndex(function (time) {\n          return time.isSame(currentHoverTime, 'month');\n        });\n        if (oriValueIndex === -1) oriValueIndex = 0;\n\n        if (value.every(function (time) {\n          return !time.isSame(nextHoverTime, 'month');\n        })) {\n          var _newValue = value.slice();\n          _newValue[oriValueIndex] = nextHoverTime.clone();\n          _this2.fireValueChange(_newValue);\n        }\n      }\n\n      event.preventDefault();\n\n      return nextHoverTime;\n    };\n\n    switch (keyCode) {\n      case KeyCode.DOWN:\n        updateHoverPoint(function (time) {\n          return goTime(time, 1, 'weeks');\n        });\n        return;\n      case KeyCode.UP:\n        updateHoverPoint(function (time) {\n          return goTime(time, -1, 'weeks');\n        });\n        return;\n      case KeyCode.LEFT:\n        if (ctrlKey) {\n          updateHoverPoint(function (time) {\n            return goTime(time, -1, 'years');\n          });\n        } else {\n          updateHoverPoint(function (time) {\n            return goTime(time, -1, 'days');\n          });\n        }\n        return;\n      case KeyCode.RIGHT:\n        if (ctrlKey) {\n          updateHoverPoint(function (time) {\n            return goTime(time, 1, 'years');\n          });\n        } else {\n          updateHoverPoint(function (time) {\n            return goTime(time, 1, 'days');\n          });\n        }\n        return;\n      case KeyCode.HOME:\n        updateHoverPoint(function (time) {\n          return goStartMonth(time);\n        });\n        return;\n      case KeyCode.END:\n        updateHoverPoint(function (time) {\n          return goEndMonth(time);\n        });\n        return;\n      case KeyCode.PAGE_DOWN:\n        updateHoverPoint(function (time) {\n          return goTime(time, 1, 'month');\n        });\n        return;\n      case KeyCode.PAGE_UP:\n        updateHoverPoint(function (time) {\n          return goTime(time, -1, 'month');\n        });\n        return;\n      case KeyCode.ENTER:\n        {\n          var lastValue = void 0;\n          if (hoverValue.length === 0) {\n            lastValue = updateHoverPoint(function (time) {\n              return time;\n            });\n          } else if (hoverValue.length === 1) {\n            lastValue = hoverValue[0];\n          } else {\n            lastValue = hoverValue[0].isSame(firstSelectedValue, 'day') ? hoverValue[1] : hoverValue[0];\n          }\n          if (lastValue && (!disabledDate || !disabledDate(lastValue))) {\n            _this2.onSelect(lastValue);\n          }\n          event.preventDefault();\n          return;\n        }\n      default:\n        if (onKeyDown) {\n          onKeyDown(event);\n        }\n    }\n  };\n\n  this.onDayHover = function (value) {\n    var hoverValue = [];\n    var _state3 = _this2.state,\n        selectedValue = _state3.selectedValue,\n        firstSelectedValue = _state3.firstSelectedValue;\n    var type = _this2.props.type;\n\n    if (type === 'start' && selectedValue[1]) {\n      hoverValue = _this2.compare(value, selectedValue[1]) < 0 ? [value, selectedValue[1]] : [value];\n    } else if (type === 'end' && selectedValue[0]) {\n      hoverValue = _this2.compare(value, selectedValue[0]) > 0 ? [selectedValue[0], value] : [];\n    } else {\n      if (!firstSelectedValue) {\n        if (_this2.state.hoverValue.length) {\n          _this2.setState({ hoverValue: [] });\n        }\n        return hoverValue;\n      }\n      hoverValue = _this2.compare(value, firstSelectedValue) < 0 ? [value, firstSelectedValue] : [firstSelectedValue, value];\n    }\n    _this2.fireHoverValueChange(hoverValue);\n\n    return hoverValue;\n  };\n\n  this.onToday = function () {\n    var startValue = getTodayTime(_this2.state.value[0]);\n    var endValue = startValue.clone().add(1, 'months');\n    _this2.setState({ value: [startValue, endValue] });\n  };\n\n  this.onOpenTimePicker = function () {\n    _this2.setState({\n      showTimePicker: true\n    });\n  };\n\n  this.onCloseTimePicker = function () {\n    _this2.setState({\n      showTimePicker: false\n    });\n  };\n\n  this.onOk = function () {\n    var selectedValue = _this2.state.selectedValue;\n\n    if (_this2.isAllowedDateAndTime(selectedValue)) {\n      _this2.props.onOk(_this2.state.selectedValue);\n    }\n  };\n\n  this.onStartInputChange = function () {\n    for (var _len = arguments.length, oargs = Array(_len), _key = 0; _key < _len; _key++) {\n      oargs[_key] = arguments[_key];\n    }\n\n    var args = ['left'].concat(oargs);\n    return onInputSelect.apply(_this2, args);\n  };\n\n  this.onEndInputChange = function () {\n    for (var _len2 = arguments.length, oargs = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      oargs[_key2] = arguments[_key2];\n    }\n\n    var args = ['right'].concat(oargs);\n    return onInputSelect.apply(_this2, args);\n  };\n\n  this.onStartInputSelect = function (value) {\n    var args = ['left', value, { source: 'dateInputSelect' }];\n    return onInputSelect.apply(_this2, args);\n  };\n\n  this.onEndInputSelect = function (value) {\n    var args = ['right', value, { source: 'dateInputSelect' }];\n    return onInputSelect.apply(_this2, args);\n  };\n\n  this.onStartValueChange = function (leftValue) {\n    var value = [].concat(_this2.state.value);\n    value[0] = leftValue;\n    return _this2.fireValueChange(value);\n  };\n\n  this.onEndValueChange = function (rightValue) {\n    var value = [].concat(_this2.state.value);\n    value[1] = rightValue;\n    return _this2.fireValueChange(value);\n  };\n\n  this.onStartPanelChange = function (value, mode) {\n    var props = _this2.props,\n        state = _this2.state;\n\n    var newMode = [mode, state.mode[1]];\n    if (!('mode' in props)) {\n      _this2.setState({\n        mode: newMode\n      });\n    }\n    var newValue = [value || state.value[0], state.value[1]];\n    props.onPanelChange(newValue, newMode);\n  };\n\n  this.onEndPanelChange = function (value, mode) {\n    var props = _this2.props,\n        state = _this2.state;\n\n    var newMode = [state.mode[0], mode];\n    if (!('mode' in props)) {\n      _this2.setState({\n        mode: newMode\n      });\n    }\n    var newValue = [state.value[0], value || state.value[1]];\n    props.onPanelChange(newValue, newMode);\n  };\n\n  this.getStartValue = function () {\n    var value = _this2.state.value[0];\n    var selectedValue = _this2.state.selectedValue;\n    // keep selectedTime when select date\n    if (selectedValue[0] && _this2.props.timePicker) {\n      value = value.clone();\n      syncTime(selectedValue[0], value);\n    }\n    if (_this2.state.showTimePicker && selectedValue[0]) {\n      return selectedValue[0];\n    }\n    return value;\n  };\n\n  this.getEndValue = function () {\n    var _state4 = _this2.state,\n        value = _state4.value,\n        selectedValue = _state4.selectedValue,\n        showTimePicker = _state4.showTimePicker;\n\n    var endValue = value[1] ? value[1].clone() : value[0].clone().add(1, 'month');\n    // keep selectedTime when select date\n    if (selectedValue[1] && _this2.props.timePicker) {\n      syncTime(selectedValue[1], endValue);\n    }\n    if (showTimePicker) {\n      return selectedValue[1] ? selectedValue[1] : _this2.getStartValue();\n    }\n    return endValue;\n  };\n\n  this.getEndDisableTime = function () {\n    var _state5 = _this2.state,\n        selectedValue = _state5.selectedValue,\n        value = _state5.value;\n    var disabledTime = _this2.props.disabledTime;\n\n    var userSettingDisabledTime = disabledTime(selectedValue, 'end') || {};\n    var startValue = selectedValue && selectedValue[0] || value[0].clone();\n    // if startTime and endTime is same day..\n    // the second time picker will not able to pick time before first time picker\n    if (!selectedValue[1] || startValue.isSame(selectedValue[1], 'day')) {\n      var hours = startValue.hour();\n      var minutes = startValue.minute();\n      var second = startValue.second();\n      var _disabledHours = userSettingDisabledTime.disabledHours,\n          _disabledMinutes = userSettingDisabledTime.disabledMinutes,\n          _disabledSeconds = userSettingDisabledTime.disabledSeconds;\n\n      var oldDisabledMinutes = _disabledMinutes ? _disabledMinutes() : [];\n      var olddisabledSeconds = _disabledSeconds ? _disabledSeconds() : [];\n      _disabledHours = generateOptions(hours, _disabledHours);\n      _disabledMinutes = generateOptions(minutes, _disabledMinutes);\n      _disabledSeconds = generateOptions(second, _disabledSeconds);\n      return {\n        disabledHours: function disabledHours() {\n          return _disabledHours;\n        },\n        disabledMinutes: function disabledMinutes(hour) {\n          if (hour === hours) {\n            return _disabledMinutes;\n          }\n          return oldDisabledMinutes;\n        },\n        disabledSeconds: function disabledSeconds(hour, minute) {\n          if (hour === hours && minute === minutes) {\n            return _disabledSeconds;\n          }\n          return olddisabledSeconds;\n        }\n      };\n    }\n    return userSettingDisabledTime;\n  };\n\n  this.isAllowedDateAndTime = function (selectedValue) {\n    return isAllowedDate(selectedValue[0], _this2.props.disabledDate, _this2.disabledStartTime) && isAllowedDate(selectedValue[1], _this2.props.disabledDate, _this2.disabledEndTime);\n  };\n\n  this.isMonthYearPanelShow = function (mode) {\n    return ['month', 'year', 'decade'].indexOf(mode) > -1;\n  };\n\n  this.hasSelectedValue = function () {\n    var selectedValue = _this2.state.selectedValue;\n\n    return !!selectedValue[1] && !!selectedValue[0];\n  };\n\n  this.compare = function (v1, v2) {\n    if (_this2.props.timePicker) {\n      return v1.diff(v2);\n    }\n    return v1.diff(v2, 'days');\n  };\n\n  this.fireSelectValueChange = function (selectedValue, direct, cause) {\n    var timePicker = _this2.props.timePicker;\n    var prevSelectedValue = _this2.state.prevSelectedValue;\n\n    if (timePicker && timePicker.props.defaultValue) {\n      var timePickerDefaultValue = timePicker.props.defaultValue;\n      if (!prevSelectedValue[0] && selectedValue[0]) {\n        syncTime(timePickerDefaultValue[0], selectedValue[0]);\n      }\n      if (!prevSelectedValue[1] && selectedValue[1]) {\n        syncTime(timePickerDefaultValue[1], selectedValue[1]);\n      }\n    }\n\n    if (!('selectedValue' in _this2.props)) {\n      _this2.setState({\n        selectedValue: selectedValue\n      });\n    }\n\n    // 尚未选择过时间，直接输入的话\n    if (!_this2.state.selectedValue[0] || !_this2.state.selectedValue[1]) {\n      var startValue = selectedValue[0] || moment();\n      var endValue = selectedValue[1] || startValue.clone().add(1, 'months');\n      _this2.setState({\n        selectedValue: selectedValue,\n        value: getValueFromSelectedValue([startValue, endValue])\n      });\n    }\n\n    if (selectedValue[0] && !selectedValue[1]) {\n      _this2.setState({ firstSelectedValue: selectedValue[0] });\n      _this2.fireHoverValueChange(selectedValue.concat());\n    }\n    _this2.props.onChange(selectedValue);\n    if (direct || selectedValue[0] && selectedValue[1]) {\n      _this2.setState({\n        prevSelectedValue: selectedValue,\n        firstSelectedValue: null\n      });\n      _this2.fireHoverValueChange([]);\n      _this2.props.onSelect(selectedValue, cause);\n    }\n  };\n\n  this.fireValueChange = function (value) {\n    var props = _this2.props;\n    if (!('value' in props)) {\n      _this2.setState({\n        value: value\n      });\n    }\n    props.onValueChange(value);\n  };\n\n  this.fireHoverValueChange = function (hoverValue) {\n    var props = _this2.props;\n    if (!('hoverValue' in props)) {\n      _this2.setState({ hoverValue: hoverValue });\n    }\n    props.onHoverChange(hoverValue);\n  };\n\n  this.clear = function () {\n    _this2.fireSelectValueChange([], true);\n    _this2.props.onClear();\n  };\n\n  this.disabledStartTime = function (time) {\n    return _this2.props.disabledTime(time, 'start');\n  };\n\n  this.disabledEndTime = function (time) {\n    return _this2.props.disabledTime(time, 'end');\n  };\n\n  this.disabledStartMonth = function (month) {\n    var value = _this2.state.value;\n\n    return month.isAfter(value[1], 'month');\n  };\n\n  this.disabledEndMonth = function (month) {\n    var value = _this2.state.value;\n\n    return month.isBefore(value[0], 'month');\n  };\n};\n\npolyfill(RangeCalendar);\n\nexport default commonMixinWrapper(RangeCalendar);"]},"metadata":{},"sourceType":"module"}